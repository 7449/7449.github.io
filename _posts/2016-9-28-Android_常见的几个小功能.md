---
layout: post
title: Android_常见的几个小功能
---

包含了几个android开发中常见的小功能


双击退出程序

		private long exitTime = 0;
	
	    @Override
	    public void onBackPressed() {
	        if ((System.currentTimeMillis() - exitTime) > 2000) {
	            Toast.makeText(getApplicationContext(), "再按一次退出", Toast.LENGTH_LONG).show();
	            exitTime = System.currentTimeMillis();
	        } else {
	            super.onBackPressed();
	        }
	    }

检测用户是否某个应用

	 public static boolean isApk(Context context, String packageName) {  
	        final PackageManager packageManager = context.getPackageManager();  
	        List<PackageInfo> pinfo = packageManager.getInstalledPackages(0);  
	        if (pinfo != null) {  
	            for (int i = 0; i < pinfo.size(); i++) {  
	                String pn = pinfo.get(i).packageName;  
	                if (pn.equals(packageName)) {  
	                    return true;  
	                }  
	            }  
	        }  
	        return false;  
	    }  

在代码中改变TextView的drawable的图片资源
	
	Drawable drawable = getResources().getDrawable(R.mipmap.ic_pay_koukuan);  
	drawable.setBounds(0, 0, drawable.getMinimumWidth(), drawable.getMinimumHeight());  
	tv_text.setCompoundDrawables(drawable, null, null, null);  

点击按钮实现手机震动
	
	<uses-permission android:name="android.permission.VIBRATE"/>

	  public static void vibrator(Context context) {  
	      Vibrator vibrator = (Vibrator) context.getSystemService(Context.VIBRATOR_SERVICE);  
	      //控制振动时间  
	      vibrator.vibrate(2000);  
	  } 

EditText输入限制小数点后两位

	public class EditTextUtils {  
	
	    public static void editWatcher(final EditText editText, final EditTextChanged editTextChanged) {  
	  
	        editText.addTextChangedListener(new TextWatcher() {  
	            @Override  
	            public void beforeTextChanged(CharSequence s, int start, int count, int after) {  
	                editTextChanged.beforeTextChanged();  
	            }  
	  
	            @Override  
	            public void onTextChanged(CharSequence s, int start, int before, int count) {  
	                if (s.toString().contains(".")) {  
	                    if (s.length() - 1 - s.toString().indexOf(".") > 2) {  
	                        s = s.toString().subSequence(0, s.toString().indexOf(".") + 3);  
	                        editText.setText(s);  
	                        editText.setSelection(s.length());  
	                    }  
	                }  
	            }  
	  
	            @Override  
	            public void afterTextChanged(Editable s) {   }  
	        });  
	    }  
	  
	    public interface EditTextChanged {  
	        void beforeTextChanged(); 
	    }  
	  
	}   

TextView后加字体并改变颜色点击跳转

	private void hint_onClick() {  
	    SpannableString span = new SpannableString(hint);//后加内容  
	    ClickableSpan click = new MClickableSpan(this);  
	    span.setSpan(click, 0, hint.length(), Spanned.SPAN_INCLUSIVE_EXCLUSIVE);  
	    tvHint.append(span);  
	    tvHint.setMovementMethod(LinkMovementMethod.getInstance());  
	}  

	public class MClickableSpan extends ClickableSpan { 
 
	 	@Override  
	    public void updateDrawState(TextPaint ds) {  
	        ds.setColor(Color.BLUE);  
	    }  
	  
	    @Override  
	    public void onClick(View widget) {  
	      
	    }  

	}  

apk下载完成跳转到安装界面

    public static void installApp(Context context, String filePath) {
        File _file = new File(filePath);
        Intent intent = new Intent(Intent.ACTION_VIEW);
        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        intent.setDataAndType(Uri.fromFile(_file),"application/vnd.android.package-archive");
        context.startActivity(intent);
    }

添加删除桌面快捷方式

    <uses-permission android:name="com.android.launcher.permission.INSTALL_SHORTCUT" />
    <uses-permission android:name="com.android.launcher.permission.UNINSTALL_SHORTCUT" />

    /**
     * 创建桌面快捷方式
     */
    private void addShortcut() {
        Intent shortcut = new Intent("com.android.launcher.action.INSTALL_SHORTCUT");
        //快捷方式的名称
        shortcut.putExtra(Intent.EXTRA_SHORTCUT_NAME, getString(R.string.app_name));
        shortcut.putExtra("duplicate", false); //不允许重复创建
        //指定当前的Activity为快捷方式启动的对象: 如 com.everest.video.VideoPlayer
        //注意: ComponentName的第二个参数必须加上点号(.)，否则快捷方式无法启动相应程序
        ComponentName comp = new ComponentName(this.getPackageName(), "." + this.getLocalClassName());
        shortcut.putExtra(Intent.EXTRA_SHORTCUT_INTENT, new Intent(Intent.ACTION_MAIN).setComponent(comp));
        Intent.ShortcutIconResource iconRes = Intent.ShortcutIconResource.fromContext(this, R.mipmap.ic_launcher);
        shortcut.putExtra(Intent.EXTRA_SHORTCUT_ICON_RESOURCE, iconRes);
        sendBroadcast(shortcut);
    }

    /**
     * 删除程序的快捷方式
     */
    private void delShortcut() {
        Intent shortcut = new Intent("com.android.launcher.action.UNINSTALL_SHORTCUT");
        shortcut.putExtra(Intent.EXTRA_SHORTCUT_NAME, getString(R.string.app_name));
        //指定当前的Activity为快捷方式启动的对象: 如 com.everest.video.VideoPlayer
        //注意: ComponentName的第二个参数必须是完整的类名（包名+类名），否则无法删除快捷方式
        String appClass = this.getPackageName() + "." + this.getLocalClassName();
        ComponentName comp = new ComponentName(this.getPackageName(), appClass);
        shortcut.putExtra(Intent.EXTRA_SHORTCUT_INTENT, new Intent(Intent.ACTION_MAIN).setComponent(comp));
        sendBroadcast(shortcut);
    }